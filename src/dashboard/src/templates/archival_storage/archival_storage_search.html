{% extends "layout_fluid.html" %}
{% load breadcumbs %}

{% block title %}Archival storage{% endblock %}
{% block h1 %}Archival storage{% endblock %}
{% block page_id %}archival-storage{% endblock %}

{% block js %}
  <script type="text/javascript" src="{{ STATIC_URL }}js/archival_storage/advanced-search-query-creator.js"></script>
  <script type="text/javascript" src="{{ STATIC_URL }}js/archival_storage/archival_storage_search.js"></script>
{% endblock %}

{% block css %}
  <link href="{{ STATIC_URL }}css/archival_storage.css" rel="stylesheet" type="text/css" />
{% endblock %}

{% block content %}

  <ul class="breadcrumb">
    {% breadcrumb_url 'Archival storage' components.archival_storage.views.archival_storage %}
    {% breadcrumb 'Search' %}
  </ul>

  {% include "archival_storage/_archival_storage_search_form.html" %}

  {% if results %}
    {% include "archival_storage/_archival_storage_search_summary.html" %}

    <!--
    <div style='width: 80px; float: left; padding: 10px; margin-right: 10px; background-color: #eee;'>
    {% for term_usage in file_extension_usage %}
      {{ term_usage.term }} ({{ term_usage.count }})<br/>
    {% endfor %}
    </div>
    -->

    <div style='float: left'>
    {% for item in results %}
      <div>{{item.filename}}</div>
      <div class='aip-search-item-details'>
        <div>
          {% if item.sipname %}
            <span class='aip-search-item-detail-field'>AIP: {{ item.sipname }} <a class='uuid' href="{% url components.archival_storage.views.archival_storage_sip_download item.AIPUUID %}">{{item.AIPUUID}}</a></span>
            <span class='aip-search-item-detail-field'>Indexed at: <script>document.write(timestampToLocal({{item.indexedAt}}))</script></span>
            <a href='/archival-storage/search/json/file/{{ item.document_id_no_hyphens }}/' target='_blank'>(view raw)</a>
          {% else %}
            (AIP {{item.AIPUUID}} details missing from database.)
          {% endif %}
        </div>
      </div>
    {% endfor %}
    </div>

    <div style='clear: both'>
    {% include "archival_storage/_archival_storage_search_summary.html" %}
    </div>

  {% else %}
    <div id='aip-search-summary'>No results, please try another search.</div>
  {% endif %}

{% endblock %}
